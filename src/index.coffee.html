<!DOCTYPE html>
<html>
<head>
  <title>index.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-filelist.js"></script>
  <script>
    var relativeDir = "../";
    var thisFile = "src/index.coffee";
    var defaultSidebar = true;
  </script>
  <script src="../doc-script.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1.0" /></head>
<body>
  <nav>
<div class="logo"><a href="http://alinex.github.io"
  onmouseover="logo.src='https://alinex.github.io/images/Alinex-200.png'"
  onmouseout="logo.src='https://alinex.github.io/images/Alinex-black-200.png'">
  <img name="logo" src="https://alinex.github.io/images/Alinex-black-200.png"
    width="150" title="Alinex Universe Homepage" />
  </a>
  <img src="http://alinex.github.io/images/Alinex-200.png"
    style="display:none" alt="preloading" />
</div>
<div class="links">
  <a href="http://alinex.github.io/blog"
    class="btn btn-primary"><span class="glyphicon-pencil"></span> Blog</a>
  <a href="http://alinex.github.io/develop"
    class="btn btn-primary"><span class="glyphicon-book"></span> Develop</a>
  <a href="http://alinex.github.io/code.html"
    class="btn btn-warning"><span class="glyphicon-cog"></span> Code</a>
</div>
</nav><div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#report-generation">Report generation</a>
      </div>

      <div class="heading h2">
        <a href="#node-modules">Node Modules</a>
      </div>

      <div class="heading h2">
        <a href="#helper-methods">Helper methods</a>
      </div>

      <div class="heading h3">
        <a href="#convert-object-to-markdown-table">Convert object to markdown table</a>
      </div>

      <div class="heading h2">
        <a href="#report-class">Report class</a>
      </div>

      <div class="heading h2">
        <a href="#static-methods">Static Methods</a>
      </div>

      <div class="heading h3">
        <a href="#headings">headings</a>
      </div>

      <div class="heading h3">
        <a href="#inline">inline</a>
      </div>

      <div class="heading h3">
        <a href="#multi-element">Multi element</a>
      </div>

      <div class="heading h3">
        <a href="#paragraphs">paragraphs</a>
      </div>

      <div class="heading h3">
        <a href="#lists">lists</a>
      </div>

      <div class="heading h3">
        <a href="#specials">specials</a>
      </div>

      <div class="heading h3">
        <a href="#visualizations">Visualizations</a>
      </div>

      <div class="heading h2">
        <a href="#create-instance">Create instance</a>
      </div>

      <div class="heading h2">
        <a href="#add-elements">Add elements</a>
      </div>

      <div class="heading h3">
        <a href="#direct-markdown-addition">direct markdown addition</a>
      </div>

      <div class="heading h3">
        <a href="#add-contents-of-other-report-instance">add contents of other report instance</a>
      </div>

      <div class="heading h3">
        <a href="#headings-1">headings</a>
      </div>

      <div class="heading h3">
        <a href="#paragraphs-1">paragraphs</a>
      </div>

      <div class="heading h3">
        <a href="#lists-1">lists</a>
      </div>

      <div class="heading h2">
        <a href="#extract-report">Extract report</a>
      </div>

      <div class="heading h3">
        <a href="#as-markdown-text">as markdown text</a>
      </div>

      <div class="heading h3">
        <a href="#as-simplified-text">as simplified text</a>
      </div>

      <div class="heading h3">
        <a href="#as-colorful-console-text">as colorful console text</a>
      </div>

      <div class="heading h3">
        <a href="#as-html">as html</a>
      </div>

      <div class="heading h3">
        <a href="#as-pdf">as pdf</a>
      </div>

      <div class="heading h3">
        <a href="#as-image-pngjpeg">as image (png/jpeg)</a>
      </div>

      <div class="heading h2">
        <a href="#export-class">Export class</a>
      </div>

      <div class="heading h2">
        <a href="#helper-methods-1">Helper methods</a>
      </div>

      <div class="heading h3">
        <a href="#strip-ansi-color-codes">strip ansi color codes</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container" tabindex="0"><a id="fork" href="https://github.com/alinex/node-report" title="Fork me on GitHub"></a>
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="report-generation">
  <h1>
    <a href="#report-generation" name="report-generation" class="pilcrow"></a>
Report generation
  </h1>
</div>
<p>This package will give you an easy and robust way to access mysql databases.</p>

        </td>
        <td class="code highlight">
          
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="node-modules">
  <h2>
    <a href="#node-modules" name="node-modules" class="pilcrow"></a>
Node Modules
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">chalk = <span class="hljs-built_in">require</span> <span class="hljs-string">'chalk'</span>
deasync = <span class="hljs-built_in">require</span> <span class="hljs-string">'deasync'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>include more alinex modules</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">util = <span class="hljs-built_in">require</span> <span class="hljs-string">'alinex-util'</span>
Table = <span class="hljs-built_in">require</span> <span class="hljs-string">'alinex-table'</span>
format = <span class="hljs-built_in">require</span> <span class="hljs-string">'alinex-format'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>load local plugins</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">pluginCode = <span class="hljs-built_in">require</span> <span class="hljs-string">'./plugin/code'</span>
dataStringify = deasync format.stringify</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="helper-methods">
  <h2>
    <a href="#helper-methods" name="helper-methods" class="pilcrow"></a>
Helper methods
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function">
<span class="hljs-title">block</span> = <span class="hljs-params">(text, start, indent, width, pre = <span class="hljs-literal">false</span>)</span> -&gt;</span>
  indent = <span class="hljs-string">'\n'</span> + indent
  text = text.trim().replace <span class="hljs-regexp">/([^\\\s])[ \r\t]*\n[ \r\t]*(\S)/g</span>, <span class="hljs-string">'$1\n$2'</span> <span class="hljs-keyword">unless</span> pre
  text = <span class="hljs-string">'\n'</span> + start + text.replace(<span class="hljs-regexp">/\n/g</span>, indent) + <span class="hljs-string">'\n'</span>
  util.string.wordwrap text, width, indent, <span class="hljs-number">2</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="convert-object-to-markdown-table">
  <h3>
    <a href="#convert-object-to-markdown-table" name="convert-object-to-markdown-table" class="pilcrow"></a>
Convert object to markdown table
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function"><span class="hljs-title">table</span> = <span class="hljs-params">(obj, col, sort, mask)</span> -&gt;</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>table instance</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">if</span> obj <span class="hljs-keyword">instanceof</span> Table
    table = obj
    obj = table.data[<span class="hljs-number">1.</span>.]
    col = []
    <span class="hljs-keyword">for</span> name, i <span class="hljs-keyword">in</span> table.data[<span class="hljs-number">0</span>]
      res = table.getMeta <span class="hljs-literal">null</span>, i
      res.title ?= name
      col.push res
  <span class="hljs-keyword">return</span> <span class="hljs-string">''</span> <span class="hljs-keyword">unless</span> Object.keys(obj).length
  obj = util.clone obj</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>transform object</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> obj <span class="hljs-keyword">is</span> <span class="hljs-string">'object'</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> Array.isArray obj
    n = [(col ? [<span class="hljs-string">'Name'</span>, <span class="hljs-string">'Value'</span>])]
    col = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">for</span> name, val <span class="hljs-keyword">of</span> obj
      <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> val <span class="hljs-keyword">is</span> <span class="hljs-string">'object'</span>
        <span class="hljs-keyword">if</span> Array.isArray(val) <span class="hljs-keyword">and</span> val.length &lt; <span class="hljs-number">10</span>
          n.push [name, val.join <span class="hljs-string">', '</span>]
        <span class="hljs-keyword">else</span>
          <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">of</span> val
            n.push [<span class="hljs-string">"<span class="hljs-subst">#{name}</span>.<span class="hljs-subst">#{k}</span>"</span>, v]
      <span class="hljs-keyword">else</span>
        n.push [name, val]
    obj = n.map (r) -&gt;
      r.map (c) -&gt;
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> c <span class="hljs-keyword">is</span> <span class="hljs-string">'string'</span> <span class="hljs-keyword">then</span> c.replace <span class="hljs-regexp">/\s*\n\s*/g</span>, <span class="hljs-string">' '</span> <span class="hljs-keyword">else</span> c</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>transform column definition</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">if</span> col
    <span class="hljs-keyword">if</span> Array.isArray(col)
      <span class="hljs-keyword">unless</span> Array.isArray col[<span class="hljs-number">0</span>]
        col = [
          Object.keys obj[<span class="hljs-number">0</span>]
          col
        ]
      n = {}
      <span class="hljs-keyword">for</span> name, num <span class="hljs-keyword">in</span> col[<span class="hljs-number">0</span>]
        <span class="hljs-keyword">break</span> <span class="hljs-keyword">unless</span> val = col[<span class="hljs-number">1</span>][num]
        n[name] = <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> val <span class="hljs-keyword">is</span> <span class="hljs-string">'object'</span> <span class="hljs-keyword">then</span> val <span class="hljs-keyword">else</span> {title: val}
      col = n
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> col[Object.keys(col)[<span class="hljs-number">0</span>]] <span class="hljs-keyword">isnt</span> <span class="hljs-string">'object'</span>
      n = {}
      n[name] = {title: title} <span class="hljs-keyword">for</span> name, title <span class="hljs-keyword">of</span> col
      col = n
  <span class="hljs-keyword">else</span>
    <span class="hljs-keyword">if</span> Array.isArray obj[<span class="hljs-number">0</span>]
      col = obj.shift()
    <span class="hljs-keyword">else</span>
      col = {}
      col[name] = {title: name} <span class="hljs-keyword">for</span> name <span class="hljs-keyword">of</span> obj[<span class="hljs-number">0</span>]</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>transform col array to object</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">if</span> Array.isArray col
    c = {}
    <span class="hljs-keyword">for</span> field, i <span class="hljs-keyword">in</span> col
      c[i] = <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> field <span class="hljs-keyword">is</span> <span class="hljs-string">'object'</span> <span class="hljs-keyword">then</span> field <span class="hljs-keyword">else</span> {title: field}
    col = c</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>transform sort order</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> sort <span class="hljs-keyword">is</span> <span class="hljs-string">'string'</span>
    n = {}
    n[sort] = <span class="hljs-string">'asc'</span>
    sort = n
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> Array.isArray sort
    n = {}
    n[key] = <span class="hljs-string">'asc'</span> <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> sort
    sort = n</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>transform values</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  obj = obj.map (row) -&gt;
    <span class="hljs-keyword">if</span> Array.isArray row
      row.map (col) -&gt; col?.toString() ? <span class="hljs-string">''</span>
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">for</span> key <span class="hljs-keyword">of</span> row
        row[key] = row[key]?.toString() ? <span class="hljs-string">''</span>
      row</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>mask values if needed</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">if</span> mask
    obj = obj.map (row) -&gt;
      <span class="hljs-keyword">if</span> Array.isArray row
        row.map (col) -&gt; Report.mask col
      <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">for</span> key <span class="hljs-keyword">of</span> row
          row[key] = Report.mask row[key]
        row</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>calculate column width</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">for</span> key <span class="hljs-keyword">of</span> col
    col[key].width = col[key].title?.toString().length ? <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> obj
      <span class="hljs-keyword">continue</span> <span class="hljs-keyword">unless</span> row[key]?
      col[key].width = row[key].length <span class="hljs-keyword">if</span> row[key].length &gt; col[key].width
      col[key].align ?= <span class="hljs-string">'left'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>sort rows</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">if</span> sort
    obj = obj.slice()
    obj.sort (a, b) -&gt;
      <span class="hljs-keyword">for</span> name, order <span class="hljs-keyword">of</span> sort
        res = a[name].localeCompare b[name]
        res = res * <span class="hljs-number">-1</span> <span class="hljs-keyword">if</span> order <span class="hljs-keyword">is</span> <span class="hljs-string">'desc'</span>
        <span class="hljs-keyword">return</span> res <span class="hljs-keyword">if</span> res
      <span class="hljs-number">0</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>write header</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  text = <span class="hljs-string">'\n| '</span> + (
    Object.keys(col).map (e) -&gt;
      pad = <span class="hljs-keyword">switch</span> col[e].align?[<span class="hljs-number">0</span>]
        <span class="hljs-keyword">when</span> <span class="hljs-string">'r'</span> <span class="hljs-keyword">then</span> <span class="hljs-string">'l'</span>
        <span class="hljs-keyword">when</span> <span class="hljs-string">'l'</span> <span class="hljs-keyword">then</span> <span class="hljs-string">'r'</span>
        <span class="hljs-keyword">else</span> <span class="hljs-string">'c'</span>
      util.string[<span class="hljs-string">"<span class="hljs-subst">#{pad}</span>pad"</span>] col[e].title, col[e].width
    .join <span class="hljs-string">' | '</span>
  ) + <span class="hljs-string">' |'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>write line</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  text += <span class="hljs-string">'\n|'</span> + (
    Object.keys(col).map (e) -&gt;
      <span class="hljs-keyword">switch</span> col[e].align
        <span class="hljs-keyword">when</span> <span class="hljs-string">'right'</span>
          <span class="hljs-string">" <span class="hljs-subst">#{util.string.repeat <span class="hljs-string">'-'</span>, col[e].width}</span>:"</span>
        <span class="hljs-keyword">when</span> <span class="hljs-string">'left'</span>
          <span class="hljs-string">":<span class="hljs-subst">#{util.string.repeat <span class="hljs-string">'-'</span>, col[e].width}</span> "</span>
        <span class="hljs-keyword">when</span> <span class="hljs-string">'center'</span>
          <span class="hljs-string">":<span class="hljs-subst">#{util.string.repeat <span class="hljs-string">'-'</span>, col[e].width}</span>:"</span>
    .join <span class="hljs-string">'|'</span>
  ) + <span class="hljs-string">'|'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>write rows</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> obj
    text += <span class="hljs-string">'\n| '</span> + (
      Object.keys(col).map (e) -&gt;
        pad = <span class="hljs-keyword">switch</span> col[e].align?[<span class="hljs-number">0</span>]
          <span class="hljs-keyword">when</span> <span class="hljs-string">'r'</span> <span class="hljs-keyword">then</span> <span class="hljs-string">'l'</span>
          <span class="hljs-keyword">when</span> <span class="hljs-string">'l'</span> <span class="hljs-keyword">then</span> <span class="hljs-string">'r'</span>
          <span class="hljs-keyword">else</span> <span class="hljs-string">'c'</span>
        val = row[e]
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> val <span class="hljs-keyword">is</span> <span class="hljs-string">'undefined'</span>
          val = <span class="hljs-string">''</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> val <span class="hljs-keyword">isnt</span> <span class="hljs-string">'string'</span>
          val = util.inspect(val).replace <span class="hljs-regexp">/\s+/g</span>, <span class="hljs-string">' '</span>
        util.string[<span class="hljs-string">"<span class="hljs-subst">#{pad}</span>pad"</span>] val, col[e].width
      .join <span class="hljs-string">' | '</span>
    ) + <span class="hljs-string">' |'</span>
  text + <span class="hljs-string">'\n'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="report-class">
  <h2>
    <a href="#report-class" name="report-class" class="pilcrow"></a>
Report class
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Report</span></span>

  @width: <span class="hljs-number">80</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="static-methods">
  <h2>
    <a href="#static-methods" name="static-methods" class="pilcrow"></a>
Static Methods
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">
  @mask: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span>
    text?.toString().replace <span class="hljs-regexp">/([*_~^`])/g</span>, <span class="hljs-string">'\\$1'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="headings">
  <h3>
    <a href="#headings" name="headings" class="pilcrow"></a>
headings
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  @h1: <span class="hljs-function"><span class="hljs-params">(text, width)</span> -&gt;</span>
    <span class="hljs-string">"""\n\n<span class="hljs-subst">#{text}</span>
</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<p>{util.string.repeat '=', width ? @width}\n&quot;&quot;&quot;</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  @h2: <span class="hljs-function"><span class="hljs-params">(text, width)</span> -&gt;</span>
    <span class="hljs-string">"""\n\n<span class="hljs-subst">#{text}</span>
</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23"></a>
</div>
<p>{util.string.repeat '-', width ? @width}\n&quot;&quot;&quot;</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  @h3: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span> <span class="hljs-string">"\n### <span class="hljs-subst">#{text}</span>\n"</span>
  @h4: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span> <span class="hljs-string">"\n#### <span class="hljs-subst">#{text}</span>\n"</span>
  @h5: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span> <span class="hljs-string">"\n##### <span class="hljs-subst">#{text}</span>\n"</span>
  @h6: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span> <span class="hljs-string">"\n###### <span class="hljs-subst">#{text}</span>\n"</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="inline">
  <h3>
    <a href="#inline" name="inline" class="pilcrow"></a>
inline
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  @b: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span> <span class="hljs-string">"__<span class="hljs-subst">#{text}</span>__"</span>
  @i: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span> <span class="hljs-string">"_<span class="hljs-subst">#{text}</span>_"</span>
  @del: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span> <span class="hljs-string">"~~<span class="hljs-subst">#{text}</span>~~"</span>
  @tt: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span> <span class="hljs-string">"`<span class="hljs-subst">#{text}</span>`"</span>
  @sub: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span> <span class="hljs-string">"~<span class="hljs-subst">#{text}</span>~"</span>
  @sup: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span> <span class="hljs-string">"^<span class="hljs-subst">#{text}</span>^"</span>
  @mark: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span> <span class="hljs-string">"==<span class="hljs-subst">#{text}</span>=="</span>
  @br: <span class="hljs-function">-&gt;</span> <span class="hljs-string">'\\\n'</span>
  @a: <span class="hljs-function"><span class="hljs-params">(text, url, title)</span> -&gt;</span>
    <span class="hljs-string">"[<span class="hljs-subst">#{text}</span>](<span class="hljs-subst">#{url}</span><span class="hljs-subst">#{<span class="hljs-keyword">if</span> title <span class="hljs-keyword">then</span> <span class="hljs-string">' "'</span>+title+<span class="hljs-string">'"'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">''</span>}</span>)"</span>
  @img: <span class="hljs-function"><span class="hljs-params">(text, url, title)</span> -&gt;</span>
    <span class="hljs-string">"![<span class="hljs-subst">#{text}</span>](<span class="hljs-subst">#{url}</span><span class="hljs-subst">#{<span class="hljs-keyword">if</span> title <span class="hljs-keyword">then</span> <span class="hljs-string">' "'</span>+title+<span class="hljs-string">'"'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">''</span>}</span>)"</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="multi-element">
  <h3>
    <a href="#multi-element" name="multi-element" class="pilcrow"></a>
Multi element
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  @footnote: <span class="hljs-function"><span class="hljs-params">(id, text)</span> -&gt;</span>
    [<span class="hljs-string">"[^<span class="hljs-subst">#{id}</span>]"</span>, <span class="hljs-string">"\n[^<span class="hljs-subst">#{id}</span>]: <span class="hljs-subst">#{text}</span>\n"</span>]</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="paragraphs">
  <h3>
    <a href="#paragraphs" name="paragraphs" class="pilcrow"></a>
paragraphs
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  @p: <span class="hljs-function"><span class="hljs-params">(text, width)</span> -&gt;</span> block text, <span class="hljs-string">''</span>, <span class="hljs-string">''</span>, width ? @width
  @quote: <span class="hljs-function"><span class="hljs-params">(text, depth = <span class="hljs-number">1</span>, width)</span> -&gt;</span>
    indent = util.string.repeat <span class="hljs-string">'&gt; '</span>, depth
    block text, indent, indent, width ? @width
  @code: <span class="hljs-function"><span class="hljs-params">(text, lang, width)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> lang
      <span class="hljs-keyword">return</span> <span class="hljs-string">"\n``` <span class="hljs-subst">#{lang}</span>\n<span class="hljs-subst">#{text.replace <span class="hljs-regexp">/^\s*\n|\n\s*$/</span>, <span class="hljs-string">''</span>}</span>\n```\n"</span>
    indent = <span class="hljs-string">'    '</span>
    block text, indent, indent, width ? @width, <span class="hljs-literal">true</span>
  @box: <span class="hljs-function"><span class="hljs-params">(text, type, width)</span> -&gt;</span>
    <span class="hljs-keyword">unless</span> type <span class="hljs-keyword">in</span> [<span class="hljs-string">'detail'</span>, <span class="hljs-string">'info'</span>, <span class="hljs-string">'warning'</span>, <span class="hljs-string">'alert'</span>]
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Error <span class="hljs-string">"Unknown box type <span class="hljs-subst">#{type}</span> for report"</span>
    <span class="hljs-keyword">return</span> @p text <span class="hljs-keyword">unless</span> type
    <span class="hljs-keyword">return</span> <span class="hljs-string">"\n::: <span class="hljs-subst">#{type}</span>\n<span class="hljs-subst">#{text.trim()}</span>\n:::\n"</span>
    indent = <span class="hljs-string">''</span>
    block text, indent, indent, width ? @width
  @hr: <span class="hljs-function">-&gt;</span> <span class="hljs-string">"\n---\n"</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="lists">
  <h3>
    <a href="#lists" name="lists" class="pilcrow"></a>
lists
  </h3>
</div>
<p>maybe use '\\n' at the end of line for breaks</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  @ul: <span class="hljs-function"><span class="hljs-params">(list, sort, width)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> sort?
      list = list[<span class="hljs-number">0.</span>.]
      list.sort()
      list.reverse() <span class="hljs-keyword">unless</span> sort
    <span class="hljs-string">'\n'</span> + list.map (text) =&gt;
      <span class="hljs-keyword">if</span> Array.isArray text
        text = @ul text, width
        <span class="hljs-keyword">return</span> <span class="hljs-string">'  '</span> + text.trim().replace <span class="hljs-string">'\n'</span>, <span class="hljs-string">'\n  '</span>
      text = block(text, <span class="hljs-string">'- '</span>, <span class="hljs-string">'  '</span>, width ? @width).trim()
      text
    .join(<span class="hljs-string">'\n'</span>) + <span class="hljs-string">'\n'</span>
  @ol: <span class="hljs-function"><span class="hljs-params">(list, sort, width)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> sort?
      list = list[<span class="hljs-number">0.</span>.]
      list.sort()
      list.reverse() <span class="hljs-keyword">unless</span> sort
    length = list.length.toString().length + <span class="hljs-number">2</span>
    indent = util.string.repeat <span class="hljs-string">' '</span>, length
    num = <span class="hljs-number">0</span>
    <span class="hljs-string">'\n'</span> + list.map (text) =&gt;
      <span class="hljs-keyword">if</span> Array.isArray text
        text = @ol text, width
        <span class="hljs-keyword">return</span> indent + text.trim().replace <span class="hljs-string">'\n'</span>, <span class="hljs-string">'\n'</span> + indent
      start = util.string.rpad <span class="hljs-string">"<span class="hljs-subst">#{++num}</span>."</span>, length
      block(text, start, indent, width ? @width).trim()
    .join(<span class="hljs-string">'\n'</span>) + <span class="hljs-string">'\n'</span>
  @dl: <span class="hljs-function"><span class="hljs-params">(obj, sort, width)</span> -&gt;</span>
    list = Object.keys obj
    <span class="hljs-keyword">if</span> sort?
      list = list[<span class="hljs-number">0.</span>.]
      list.sort()
      list.reverse() <span class="hljs-keyword">unless</span> sort
    text = <span class="hljs-string">''</span>
    <span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> list
      content = obj[name].trim().split(<span class="hljs-regexp">/\n\n/</span>).map (e) -&gt;
        <span class="hljs-string">": <span class="hljs-subst">#{util.string.wordwrap e, width ? @width, <span class="hljs-string">'\n'</span>}</span>"</span>
      .join <span class="hljs-string">'\n\n'</span>
      text += <span class="hljs-string">"\n<span class="hljs-subst">#{name}</span>\n\n<span class="hljs-subst">#{content}</span>\n"</span>
    text
  @check: <span class="hljs-function"><span class="hljs-params">(map)</span> -&gt;</span>
    text = <span class="hljs-string">''</span>
    <span class="hljs-keyword">for</span> name, val <span class="hljs-keyword">of</span> map
      text += <span class="hljs-string">"\n[<span class="hljs-subst">#{<span class="hljs-keyword">if</span> val <span class="hljs-keyword">then</span> <span class="hljs-string">'x'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">' '</span>}</span>] <span class="hljs-subst">#{name}</span>"</span>
    text + <span class="hljs-string">'\n'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="specials">
  <h3>
    <a href="#specials" name="specials" class="pilcrow"></a>
specials
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  @table: table
  @abbr: <span class="hljs-function"><span class="hljs-params">(abbr, text)</span> -&gt;</span> <span class="hljs-string">"\n*[<span class="hljs-subst">#{abbr}</span>]: <span class="hljs-subst">#{text.trim()}</span>"</span>
  @toc: <span class="hljs-function">-&gt;</span> <span class="hljs-string">'\n@[toc]\n'</span>
  @style: <span class="hljs-function"><span class="hljs-params">(style)</span> -&gt;</span> <span class="hljs-string">"&lt;!-- {<span class="hljs-subst">#{style}</span>} --&gt;"</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="visualizations">
  <h3>
    <a href="#visualizations" name="visualizations" class="pilcrow"></a>
Visualizations
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  @qr: <span class="hljs-function"><span class="hljs-params">(data)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> data <span class="hljs-keyword">is</span> <span class="hljs-string">'object'</span>
      <span class="hljs-string">"\n$$$ qr\n<span class="hljs-subst">#{dataStringify data, <span class="hljs-string">'yaml'</span>}</span>$$$\n"</span>
    <span class="hljs-keyword">else</span>
      <span class="hljs-string">"\n$$$ qr\n<span class="hljs-subst">#{data}</span>\n$$$\n"</span>
  @chart: <span class="hljs-function"><span class="hljs-params">(setup, data)</span> -&gt;</span>
    <span class="hljs-string">"\n$$$ chart<span class="hljs-subst">#{<span class="hljs-keyword">if</span> setup <span class="hljs-keyword">then</span> <span class="hljs-string">'\n'</span> + dataStringify(setup, <span class="hljs-string">'yaml'</span>) + <span class="hljs-string">'\n'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">''</span>}</span>\
</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30"></a>
</div>
<p>{Report.table data}$$$\n&quot;</p>

        </td>
        <td class="code highlight">
          
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="create-instance">
  <h2>
    <a href="#create-instance" name="create-instance" class="pilcrow"></a>
Create instance
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  constructor: <span class="hljs-function"><span class="hljs-params">(setup)</span> -&gt;</span>
    @width = setup?.width ? <span class="hljs-number">80</span>
    @log = setup?.log</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32"></a>
</div>
<p>content of markdown</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    @body = setup?.source ? <span class="hljs-string">''</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33"></a>
</div>
<p>different collections integrating on conversion</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    @parts =
      abbr: []
      footnote: []
      header: []
      js: []
      css: []</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34"></a>
</div>
<p>current states</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    @state =
      footnote: <span class="hljs-number">0</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="add-elements">
  <h2>
    <a href="#add-elements" name="add-elements" class="pilcrow"></a>
Add elements
  </h2>
</div>

        </td>
        <td class="code highlight">
          
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="direct-markdown-addition">
  <h3>
    <a href="#direct-markdown-addition" name="direct-markdown-addition" class="pilcrow"></a>
direct markdown addition
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  raw: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span>
    @log text <span class="hljs-keyword">if</span> @log
    @body += text
    <span class="hljs-keyword">this</span>

  html: <span class="hljs-function"><span class="hljs-params">(type, content)</span> -&gt;</span>
    <span class="hljs-keyword">switch</span> type
      <span class="hljs-keyword">when</span> <span class="hljs-string">'tag'</span> <span class="hljs-keyword">then</span> @parts.header.push content
      <span class="hljs-keyword">when</span> <span class="hljs-string">'js'</span> <span class="hljs-keyword">then</span> @parts.js.push content
      <span class="hljs-keyword">when</span> <span class="hljs-string">'css'</span> <span class="hljs-keyword">then</span> @parts.css.push content
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Error <span class="hljs-string">"Undefined type '<span class="hljs-subst">#{type}</span>' in call of report.html"</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="add-contents-of-other-report-instance">
  <h3>
    <a href="#add-contents-of-other-report-instance" name="add-contents-of-other-report-instance" class="pilcrow"></a>
add contents of other report instance
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  add: <span class="hljs-function"><span class="hljs-params">(report)</span> -&gt;</span>
    @log report.body <span class="hljs-keyword">if</span> @log
    @body += report.body
    <span class="hljs-keyword">for</span> key <span class="hljs-keyword">of</span> @parts
      @parts[key] = @parts[key].concat report.parts[key]
    <span class="hljs-keyword">this</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="headings-1">
  <h3>
    <a href="#headings-1" name="headings-1" class="pilcrow"></a>
headings
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  h1: <span class="hljs-function"><span class="hljs-params">(text, width)</span> -&gt;</span> @raw Report.h1 text, width ? @width
  h2: <span class="hljs-function"><span class="hljs-params">(text, width)</span> -&gt;</span> @raw Report.h2 text, width ? @width
  h3: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span> @raw Report.h3 text, @width
  h4: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span> @raw Report.h4 text, @width
  h5: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span> @raw Report.h5 text, @width
  h6: <span class="hljs-function"><span class="hljs-params">(text)</span> -&gt;</span> @raw Report.h6 text, @width</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="paragraphs-1">
  <h3>
    <a href="#paragraphs-1" name="paragraphs-1" class="pilcrow"></a>
paragraphs
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  p: <span class="hljs-function"><span class="hljs-params">(text, width)</span> -&gt;</span> @raw Report.p text, width ? @width
  hr: <span class="hljs-function">-&gt;</span> @raw Report.hr()
  quote: <span class="hljs-function"><span class="hljs-params">(text, depth, width)</span> -&gt;</span> @raw Report.quote text, depth, width ? @width
  code: <span class="hljs-function"><span class="hljs-params">(text, lang)</span> -&gt;</span> @raw Report.code text, lang, @width
  box: <span class="hljs-function"><span class="hljs-params">(text, type)</span> -&gt;</span> @raw Report.box text, type, @width</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="lists-1">
  <h3>
    <a href="#lists-1" name="lists-1" class="pilcrow"></a>
lists
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  ul: <span class="hljs-function"><span class="hljs-params">(list, sort)</span> -&gt;</span> @raw Report.ul list, sort, @width
  ol: <span class="hljs-function"><span class="hljs-params">(list, sort)</span> -&gt;</span> @raw Report.ol list, sort, @width
  dl: <span class="hljs-function"><span class="hljs-params">(obj, sort)</span> -&gt;</span> @raw Report.dl obj, sort, @width
  check: <span class="hljs-function"><span class="hljs-params">(map)</span> -&gt;</span> @raw Report.check map

  table: <span class="hljs-function"><span class="hljs-params">(obj, col, sort, mask)</span> -&gt;</span> @raw Report.table obj, col, sort, mask

  footnote: <span class="hljs-function"><span class="hljs-params">(text, id)</span> -&gt;</span>
    id ?= ++@state.footnote
    @parts.footnote.push <span class="hljs-string">"[^<span class="hljs-subst">#{id}</span>]: <span class="hljs-subst">#{text.trim()}</span>"</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"[^<span class="hljs-subst">#{id}</span>]"</span>

  abbr: <span class="hljs-function"><span class="hljs-params">(abbr, text)</span> -&gt;</span> @raw Report.abbr abbr, text
  toc: <span class="hljs-function">-&gt;</span> @raw Report.toc()

  qr: <span class="hljs-function"><span class="hljs-params">(data)</span> -&gt;</span> @raw Report.qr data
  chart: <span class="hljs-function"><span class="hljs-params">(setup, data)</span> -&gt;</span> @raw Report.chart setup, data</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="extract-report">
  <h2>
    <a href="#extract-report" name="extract-report" class="pilcrow"></a>
Extract report
  </h2>
</div>

        </td>
        <td class="code highlight">
          
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="as-markdown-text">
  <h3>
    <a href="#as-markdown-text" name="as-markdown-text" class="pilcrow"></a>
as markdown text
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  toString: <span class="hljs-function">-&gt;</span>
    text = @body
    <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> [<span class="hljs-string">'abbr'</span>, <span class="hljs-string">'footnote'</span>]
      <span class="hljs-keyword">continue</span> <span class="hljs-keyword">unless</span> @parts[key].length
      text += <span class="hljs-string">"\n<span class="hljs-subst">#{@parts[key].join <span class="hljs-string">'\n'</span>}</span>\n"</span>
    text</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="as-simplified-text">
  <h3>
    <a href="#as-simplified-text" name="as-simplified-text" class="pilcrow"></a>
as simplified text
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  toText: <span class="hljs-function">-&gt;</span>
    text = pluginCode.toText @toString()</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-44" id="section-44"></a>
</div>
<p>remove some parts</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    text = text.replace <span class="hljs-regexp">///
    (
      (^|\n)          <span class="hljs-comment"># start or after new line</span>
      @\[toc\]\n      <span class="hljs-comment"># table of contents</span>
    |
      &lt;!--[\s\S]*?--&gt; <span class="hljs-comment"># decorator rules</span>
    |
      \\(?=\n)        <span class="hljs-comment"># backslash at end of line</span>
    )
    ///</span>g, <span class="hljs-string">''</span>
    .trim()</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45"></a>
</div>
<p>demask markdown syntax and add spaces</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    <span class="hljs-keyword">if</span> text.match <span class="hljs-regexp">/\\([*_~^`])/</span>
      demask = <span class="hljs-regexp">/\\([*_~^`])/g</span>
      text = util.string.toList(text).map (line) -&gt;</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46"></a>
</div>
<p>demask in table</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">        <span class="hljs-keyword">if</span> line.match <span class="hljs-regexp">/^\|/</span>
          line.split(<span class="hljs-string">'\|'</span>).map (cell) -&gt;
            <span class="hljs-keyword">if</span> found = cell.match demask
              cell.replace(demask, <span class="hljs-string">"$1"</span>) + util.string.repeat <span class="hljs-string">' '</span>, found.length
            <span class="hljs-keyword">else</span>
              cell
          .join <span class="hljs-string">'|'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-47" id="section-47"></a>
</div>
<p>normal demask</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">        <span class="hljs-keyword">else</span>
          line.replace demask, <span class="hljs-string">"$1"</span>
      .join <span class="hljs-string">'\n'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-48" id="section-48"></a>
</div>
<p>replace images with descriptions</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    text = text.replace <span class="hljs-regexp">///
    !\[(.*?)\]       <span class="hljs-comment"># image alt text</span>
    \(
      ([^ ]*?)        <span class="hljs-comment"># image source</span>
      (?: "(.*?)")?   <span class="hljs-comment"># title text</span>
    \)
    ///</span>g, <span class="hljs-string">'[IMAGE $1]'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="as-colorful-console-text">
  <h3>
    <a href="#as-colorful-console-text" name="as-colorful-console-text" class="pilcrow"></a>
as colorful console text
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  toConsole: <span class="hljs-function">-&gt;</span>
    text = pluginCode.toText @toString()</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-50" id="section-50"></a>
</div>
<p>replace code</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    removed = []
    text = text.replace <span class="hljs-regexp">/\n\n``` (\w+)\s*?\n([\s\S]*?)\n```\s*?\n/g</span>, <span class="hljs-function"><span class="hljs-params">(all, lang, code)</span> =&gt;</span>
      removed.push <span class="hljs-string">"\n\n<span class="hljs-subst">#{chalk.yellow lang}</span>:<span class="hljs-subst">#{block code, <span class="hljs-string">'    '</span>, <span class="hljs-string">'    '</span>, @width, <span class="hljs-literal">true</span>}</span>"</span>
      <span class="hljs-string">"$$$$$<span class="hljs-subst">#{removed.length}</span>$$$$$"</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-51" id="section-51"></a>
</div>
<p>remove some parts</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    text = text.replace <span class="hljs-regexp">///
    (
      (^|\n)          <span class="hljs-comment"># start or after new line</span>
      @\[toc\]\n      <span class="hljs-comment"># table of contents</span>
    |
      &lt;!--[\s\S]*?--&gt; <span class="hljs-comment"># decorator rules</span>
    |
      \\(?=\n)        <span class="hljs-comment"># backslash at end of line</span>
    )
    ///</span>g, <span class="hljs-string">''</span>
    .trim()</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52"></a>
</div>
<p>interpret markdown</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    text = <span class="hljs-string">'\n\n'</span> + text + <span class="hljs-string">'\n\n'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-53" id="section-53"></a>
</div>
<p>replace headings</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    text = text.replace <span class="hljs-regexp">/(^|\n\n)([^\n]+)\n(====+)\n/g</span>, <span class="hljs-function"><span class="hljs-params">(heading, start, text, line)</span> -&gt;</span>
      <span class="hljs-string">"<span class="hljs-subst">#{start}</span><span class="hljs-subst">#{chalk.bold text}</span>\n<span class="hljs-subst">#{line.replace <span class="hljs-regexp">/=/g</span>, <span class="hljs-string">'═'</span>}</span>\n"</span>
    text = text.replace <span class="hljs-regexp">/(^|\n\n)([^\n]+)\n(----+)\n/g</span>, <span class="hljs-function"><span class="hljs-params">(heading, start, text, line)</span> -&gt;</span>
      <span class="hljs-string">"<span class="hljs-subst">#{start}</span><span class="hljs-subst">#{chalk.bold text}</span>\n<span class="hljs-subst">#{line.replace <span class="hljs-regexp">/-/g</span>, <span class="hljs-string">'─'</span>}</span>\n"</span>
    text = text.replace <span class="hljs-regexp">/(^|\n\n)###+ ([^\n]+)(?=\n\n)/g</span>, <span class="hljs-function"><span class="hljs-params">(heading, start, text)</span> -&gt;</span>
      <span class="hljs-string">"<span class="hljs-subst">#{start}</span><span class="hljs-subst">#{chalk.bold.underline text}</span>"</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-54" id="section-54"></a>
</div>
<p>hr</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    text = text.replace <span class="hljs-regexp">/\n\n---+\n/g</span>, <span class="hljs-function">=&gt;</span>
      <span class="hljs-string">"\n\n<span class="hljs-subst">#{util.string.repeat <span class="hljs-string">'─'</span>, @width}</span>\n"</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-55" id="section-55"></a>
</div>
<p>typographic</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    replace =
      <span class="hljs-string">'©'</span>: <span class="hljs-regexp">/\(c\)/gi</span>
      <span class="hljs-string">'®'</span>: <span class="hljs-regexp">/\(r\)/gi</span>
      <span class="hljs-string">'™'</span>: <span class="hljs-regexp">/\(tm\)/gi</span>
      <span class="hljs-string">'§'</span>: <span class="hljs-regexp">/\(p\)/gi</span>
      <span class="hljs-string">'±'</span>: <span class="hljs-regexp">/\+-/g</span>
      <span class="hljs-string">'😋'</span>: <span class="hljs-regexp">/:yum:/g</span>
      <span class="hljs-string">'😉'</span>: <span class="hljs-regexp">/;\)|:wink:/g</span>
      <span class="hljs-string">'😃'</span>: <span class="hljs-regexp">/:-\)|:laughing:/g</span>
      <span class="hljs-string">'😢'</span>: <span class="hljs-regexp">/:-\(|:cry:/g</span>
      <span class="hljs-string">'😦'</span>: <span class="hljs-regexp">/:-O/g</span>
      <span class="hljs-string">'😎'</span>: <span class="hljs-regexp">/8-\)/g</span>
      <span class="hljs-string">'\n✘'</span>: <span class="hljs-regexp">/\n\[x\]/g</span> <span class="hljs-comment"># alternatives: ☑</span>
      <span class="hljs-string">'\n□'</span>: <span class="hljs-regexp">/\n\[ \]/g</span>
    <span class="hljs-keyword">for</span> sign, re <span class="hljs-keyword">of</span> replace
      text = text.replace re, sign</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-56" id="section-56"></a>
</div>
<p>marked text</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    text = text.replace <span class="hljs-regexp">/(^|[^\\])\*\*(.*?)\*\*/g</span>, <span class="hljs-string">'$1'</span> + chalk.bold <span class="hljs-string">'$2'</span>
    text = text.replace <span class="hljs-regexp">/(^|[^\\])__(.*?)__/g</span>, <span class="hljs-string">'$1'</span> + chalk.bold <span class="hljs-string">'$2'</span>
    text = text.replace <span class="hljs-regexp">/(^|[^\\])\*(.*?)\*/g</span>, <span class="hljs-string">'$1'</span> + chalk.italic <span class="hljs-string">'$2'</span>
    text = text.replace <span class="hljs-regexp">/(^|[^\\])_(.*?)_/g</span>, <span class="hljs-string">'$1'</span> + chalk.italic <span class="hljs-string">'$2'</span>
    text = text.replace <span class="hljs-regexp">/(^|[^\\])`(.*?)`/g</span>, <span class="hljs-string">'$1'</span> + chalk.dim.inverse <span class="hljs-string">'$2'</span>
    text = text.replace <span class="hljs-regexp">/(^|[^\\])==([\S\s]*?)==/g</span>, <span class="hljs-string">'$1'</span> + chalk.yellow.inverse <span class="hljs-string">'$2'</span>
    text = text.replace <span class="hljs-regexp">/(^|[^\\])~~([\S\s]*?)~~/g</span>, <span class="hljs-string">'$1'</span> + chalk.strikethrough <span class="hljs-string">'$2'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-57" id="section-57"></a>
</div>
<p>replace table with ascii art table</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    text = text.replace <span class="hljs-regexp">/\n\n\|[\s\S]*?\|\n\n/g</span>, <span class="hljs-function"><span class="hljs-params">(table)</span> -&gt;</span>
      lines = table.trim().split <span class="hljs-regexp">/\n/</span>
      head = lines[<span class="hljs-number">0</span>].split <span class="hljs-regexp">/\|/</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-58" id="section-58"></a>
</div>
<p>header</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">      line = <span class="hljs-string">'┌'</span>
      line += util.string.repeat(<span class="hljs-string">'─'</span>, col.length) + <span class="hljs-string">'┬'</span> <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> head[<span class="hljs-number">1.</span>.head.length<span class="hljs-number">-2</span>]
      ascii = chalk.grey line[<span class="hljs-number">0.</span>.line.length<span class="hljs-number">-2</span>] + <span class="hljs-string">'┐'</span>
      ascii += chalk.grey <span class="hljs-string">'\n│'</span>
      ascii += chalk.bold(col) + chalk.grey(<span class="hljs-string">'│'</span>) <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> head[<span class="hljs-number">1.</span>.head.length<span class="hljs-number">-2</span>]
      line = <span class="hljs-string">'\n├'</span>
      line += util.string.repeat(<span class="hljs-string">'─'</span>, col.length) + <span class="hljs-string">'┼'</span> <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> head[<span class="hljs-number">1.</span>.head.length<span class="hljs-number">-2</span>]
      ascii += chalk.grey line[<span class="hljs-number">0.</span>.line.length<span class="hljs-number">-2</span>] + <span class="hljs-string">'┤'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-59" id="section-59"></a>
</div>
<p>lines</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">      <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> lines[<span class="hljs-number">2.</span>.]
        cols = l.split <span class="hljs-regexp">/\|/</span>
        ascii += chalk.grey <span class="hljs-string">'\n│'</span>
        ascii += col + chalk.grey(<span class="hljs-string">'│'</span>) <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> cols[<span class="hljs-number">1.</span>.cols.length<span class="hljs-number">-2</span>]</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-60" id="section-60"></a>
</div>
<p>footer</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">      line = <span class="hljs-string">'\n└'</span>
      line += util.string.repeat(<span class="hljs-string">'─'</span>, col.length) + <span class="hljs-string">'┴'</span> <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> head[<span class="hljs-number">1.</span>.head.length<span class="hljs-number">-2</span>]
      ascii += chalk.grey line[<span class="hljs-number">0.</span>.line.length<span class="hljs-number">-2</span>] + <span class="hljs-string">'┘'</span>
      <span class="hljs-string">"\n\n<span class="hljs-subst">#{ascii}</span>\n\n"</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-61" id="section-61"></a>
</div>
<p>demask markdown syntax and add spaces</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    <span class="hljs-keyword">if</span> text.match <span class="hljs-regexp">/(^|[^\\])\\([*_~^`\\])/</span>
      demask = <span class="hljs-regexp">/(^|[^\\])\\([*_~^`\\])/g</span>
      text = util.string.toList(text).map (line) -&gt;</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-62" id="section-62"></a>
</div>
<p>demask in table</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">        <span class="hljs-keyword">if</span> line.match <span class="hljs-regexp">/^│/</span>
          line.split(<span class="hljs-string">'│'</span>).map (cell) -&gt;
            <span class="hljs-keyword">if</span> found = cell.match demask
              cell.replace(demask, <span class="hljs-string">"$1$2"</span>) + util.string.repeat <span class="hljs-string">' '</span>, found.length
            <span class="hljs-keyword">else</span>
              cell
          .join <span class="hljs-string">'│'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-63" id="section-63"></a>
</div>
<p>normal demask</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">        <span class="hljs-keyword">else</span>
          line.replace demask, <span class="hljs-string">"$1$2"</span>
      .join <span class="hljs-string">'\n'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-64" id="section-64"></a>
</div>
<p>replace images with descriptions</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    text = text.replace <span class="hljs-regexp">///
    !\[(.*?)\]       <span class="hljs-comment"># image alt text</span>
    \(
      ([^ ]*?)        <span class="hljs-comment"># image source</span>
      (?: "(.*?)")?   <span class="hljs-comment"># title text</span>
    \)
    ///</span>g, <span class="hljs-string">'[IMAGE $1]'</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-65" id="section-65"></a>
</div>
<p>boxes</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    text = text.replace <span class="hljs-regexp">/\n\n::: (\w+)\s*?\n([\s\S]*?)\n:::\s*?/g</span>, <span class="hljs-function"><span class="hljs-params">(all, type, text)</span> -&gt;</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-66" id="section-66"></a>
</div>
<p>get max length</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">      maxlen = <span class="hljs-number">0</span>
      <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> text.split <span class="hljs-regexp">/\n/</span>
        len = stripAnsi(line).length
        maxlen = len <span class="hljs-keyword">if</span> len &gt; maxlen
      maxlen += <span class="hljs-number">2</span>
      color = {
        detail: <span class="hljs-string">'gray'</span>
        info: <span class="hljs-string">'green'</span>
        warning: <span class="hljs-string">'yellow'</span>
        alert: <span class="hljs-string">'red'</span>
      }[type] ? <span class="hljs-string">'gray'</span>
      text = text.split(<span class="hljs-regexp">/\n/</span>).map (e) -&gt;
        <span class="hljs-string">"<span class="hljs-subst">#{chalk[color] <span class="hljs-string">'║'</span>}</span><span class="hljs-subst">#{e}</span><span class="hljs-subst">#{util.string.repeat <span class="hljs-string">' '</span>, maxlen-stripAnsi(e).length}</span>\
</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-67" id="section-67"></a>
</div>
<p>{chalk[color] '║'}&quot;</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">      <span class="hljs-string">"""\n\n<span class="hljs-subst">#{chalk[color] <span class="hljs-string">'╔'</span> + util.string.repeat(<span class="hljs-string">'═'</span>, maxlen) + <span class="hljs-string">'╗'</span>}</span>
</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-68" id="section-68"></a>
</div>
<p>{text.join '\n'}
{chalk[color] '╚' + util.string.repeat('═', maxlen) + '╝'}&quot;&quot;&quot;
readd removed parts</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">    <span class="hljs-keyword">for</span> value, num <span class="hljs-keyword">in</span> removed
      text = text.replace <span class="hljs-string">"$$$$$<span class="hljs-subst">#{num+<span class="hljs-number">1</span>}</span>$$$$$"</span>, value
    text.trim()</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="as-html">
  <h3>
    <a href="#as-html" name="as-html" class="pilcrow"></a>
as html
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  html = <span class="hljs-literal">null</span>
  toHtml: <span class="hljs-function"><span class="hljs-params">(options, cb)</span> -&gt;</span>
    html = <span class="hljs-built_in">require</span> <span class="hljs-string">'./html'</span> <span class="hljs-keyword">unless</span> html
    html <span class="hljs-keyword">this</span>, options, cb</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="as-pdf">
  <h3>
    <a href="#as-pdf" name="as-pdf" class="pilcrow"></a>
as pdf
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  toPdf: <span class="hljs-function"><span class="hljs-params">(options, cb)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> options <span class="hljs-keyword">is</span> <span class="hljs-string">'function'</span>
      cb = options
      options = {}
    options ?= {}
    options.format ?= <span class="hljs-string">'A4'</span>
    options.border ?=
      top: <span class="hljs-string">"1cm"</span>
      right: <span class="hljs-string">"1cm"</span>
      bottom: <span class="hljs-string">"1cm"</span>
      left: <span class="hljs-string">"2cm"</span>
    options.type ?= <span class="hljs-string">"pdf"</span>           <span class="hljs-comment"># allowed file types: png, jpeg, pdf</span>
    pdf = <span class="hljs-built_in">require</span> <span class="hljs-string">'html-pdf'</span>
    @toHtml (err, html) -&gt;
      <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
      pdf.create(html, options).toBuffer cb</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="as-image-pngjpeg">
  <h3>
    <a href="#as-image-pngjpeg" name="as-image-pngjpeg" class="pilcrow"></a>
as image (png/jpeg)
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  toImage: <span class="hljs-function"><span class="hljs-params">(options, cb)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> options <span class="hljs-keyword">is</span> <span class="hljs-string">'function'</span>
      cb = options
      options = {}
    options ?= {}
    options.type ?= <span class="hljs-string">"png"</span>           <span class="hljs-comment"># allowed file types: png, jpeg, pdf</span>
    options.quality ?= <span class="hljs-number">75</span>           <span class="hljs-comment"># only used for types png &amp; jpeg</span>
    @toHtml (err, html) -&gt;
      <span class="hljs-keyword">return</span> cb err <span class="hljs-keyword">if</span> err
      pdf = <span class="hljs-built_in">require</span> <span class="hljs-string">'html-pdf'</span>
      pdf.create(html, options).toBuffer cb</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="export-class">
  <h2>
    <a href="#export-class" name="export-class" class="pilcrow"></a>
Export class
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-built_in">module</span>.exports = Report</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="helper-methods-1">
  <h2>
    <a href="#helper-methods-1" name="helper-methods-1" class="pilcrow"></a>
Helper methods
  </h2>
</div>

        </td>
        <td class="code highlight">
          
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="strip-ansi-color-codes">
  <h3>
    <a href="#strip-ansi-color-codes" name="strip-ansi-color-codes" class="pilcrow"></a>
strip ansi color codes
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-function"><span class="hljs-title">stripAnsi</span> = <span class="hljs-params">(text)</span> -&gt;</span>
  text.replace  <span class="hljs-regexp">/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=&gt;&lt;]/g</span>, <span class="hljs-string">''</span></pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
